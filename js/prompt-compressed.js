var prompter_list=[];function prompt(B,A,C){p=new Prompter(C);p.open(B,A)}function Prompter(A){this.agent=navigator.userAgent.toLowerCase();this.msie=((this.agent.indexOf("msie")!=-1)&&(this.agent.indexOf("opera")==-1));this.width=300;this.height=125;this.popup=null;this.handler=A;this.type="text";this.options=[];this.maxlength=false;prompter_list.push(this);this.num=prompter_list.length-1}Prompter.prototype.open=function(A){if(arguments.length>1){default_value=arguments[1]}else{default_value=""}this.popup=document.createElement("div");w=this.popup;w.setAttribute("id","prompt-dialog-"+this.num);label=document.createElement("p");label.setAttribute("class","label");label.setAttribute("className","label");label.appendChild(document.createTextNode(A));w.appendChild(label);form=document.createElement("form");p1=document.createElement("p");p1.setAttribute("align","center");form.appendChild(p1);w.appendChild(form);margin_top=scrollbar_offset();switch(this.type){case"select":w.setAttribute("class","prompt-window");w.setAttribute("className","prompt-window");e=document.createElement("select");e.setAttribute("name","user");e.setAttribute("id","prompt-window-"+this.num+"-user");for(i=0;i<this.options.length;i++){o=document.createElement("option");o.setAttribute("value",this.options[i]);if(this.options[i].value==default_value){o.setAttribute("selected","selected")}o.appendChild(document.createTextNode(this.options[i]));e.appendChild(o)}p1.appendChild(e);break;case"textarea":w.setAttribute("class","prompt-window-textarea");w.setAttribute("className","prompt-window-textarea");e=document.createElement("textarea");e.setAttribute("name","user");e.setAttribute("id","prompt-window-"+this.num+"-user");e.setAttribute("cols",this.cols);e.setAttribute("rows",this.rows);e.style.overflow="hidden";if(this.height){w.style.height=this.height;margin_top+=Math.round(this.height/3)*-1}if(this.width){w.style.width=this.width;w.style.marginLeft=Math.round(this.width/2)*-1}e.appendChild(document.createTextNode(default_value));p1.appendChild(e);break;case"text":default:w.setAttribute("class","prompt-window");w.setAttribute("className","prompt-window");e=document.createElement("input");e.setAttribute("type","text");e.setAttribute("name","user");e.setAttribute("id","prompt-window-"+this.num+"-user");e.setAttribute("size","30");if(this.maxlength){e.setAttribute("maxlength",this.maxlength)}e.setAttribute("value",default_value);p1.appendChild(e);break}w.style.marginTop=margin_top;p2=document.createElement("p");p2.setAttribute("align","center");num=document.createElement("input");num.setAttribute("type","hidden");num.setAttribute("name","num");num.setAttribute("value",this.num);num.setAttribute("id","prompt-window-num");ok=document.createElement("input");ok.setAttribute("type","submit");ok.setAttribute("value","OK");ok.onclick=function(){if(document.all){n=this.form.elements["prompt-window-num"].value;prompter_list[n].reply(document.getElementById("prompt-window-"+n+"-user").value)}else{prompter_list[this.form.elements.num.value].reply(this.form.elements.user.value)}return false};cancel=document.createElement("input");cancel.setAttribute("type","submit");cancel.setAttribute("value","Cancel");cancel.onclick=function(){if(document.all){prompter_list[this.form.elements["prompt-window-num"].value].reply(false)}else{prompter_list[this.form.elements.num.value].reply(false)}return false};p2.appendChild(num);p2.appendChild(ok);p2.appendChild(document.createTextNode(" \u00a0 "));p2.appendChild(cancel);form.appendChild(p2);alert_timeout_end(true);textareas=document.getElementsByTagName("textarea");for(i=0;i<textareas.length;i++){if(textareas[i].getAttribute("id")!="prompt-window-"+this.num+"-user"){textareas[i].style.overflow="hidden"}}iframes=document.getElementsByTagName("iframe");for(i=0;i<iframes.length;i++){iframes[i].style.overflow="hidden"}if(document.all){document.body.appendChild(w)}else{body=document.getElementsByTagName("body")[0];body.appendChild(w)}new Effect.BlindDown("prompt-dialog-"+this.num,{duration:1,afterFinish:function(B){n=B.element.id.split("-")[2];document.getElementById("prompt-window-"+n+"-user").style.overflow="auto";document.getElementById("prompt-window-"+n+"-user").focus()}});return false};Prompter.prototype.reply=function(A){if(this.type=="textarea"){document.getElementById("prompt-window-"+this.num+"-user").style.overflow="hidden"}new Effect.BlindUp("prompt-dialog-"+this.num,{duration:1});textareas=document.getElementsByTagName("textarea");for(i=0;i<textareas.length;i++){if(textareas[i].getAttribute("id")!="prompt-window-"+this.num+"-user"){textareas[i].style.overflow="auto"}}iframes=document.getElementsByTagName("iframe");for(i=0;i<iframes.length;i++){iframes[i].style.overflow="auto"}this.handler(A);return false};var alert_timeout=false;var alert_loaded=false;var alert_select_boxes=[];function alert_timeout_end(){if(arguments.length>0){display=true}else{display=false}if(alert_timeout){window.clearTimeout(alert_timeout)}if(display){e=document.getElementById("alert-window");if(e){e.style.display="none"}}}function alert(A){if(arguments.length>1){dur=arguments[1]*1000}else{dur=3000}msie=((navigator.userAgent.toLowerCase().indexOf("msie")!=-1)&&(navigator.userAgent.toLowerCase().indexOf("opera")==-1));alert_timeout_end(true);if(!alert_loaded){w=document.createElement("div");w.setAttribute("class","alert-window");w.setAttribute("className","alert-window");w.setAttribute("id","alert-window");w.onclick=function(){alert_timeout_end();new Effect.BlindUp("alert-window",{duration:1})};table=Builder.node("table",{width:"300px",height:"100px",border:"0"});tbody=Builder.node("tbody");tr=Builder.node("tr");td=Builder.node("td",{align:"center",valign:"middle",id:"alert-window-contents"});td.innerHTML=A;tr.appendChild(td);tbody.appendChild(tr);table.appendChild(tbody);w.appendChild(table);w.style.marginTop=scrollbar_offset();if(document.all){document.body.appendChild(w)}else{body=document.getElementsByTagName("body")[0];body.appendChild(w)}alert_loaded=true}else{document.getElementById("alert-window").style.marginTop=scrollbar_offset();document.getElementById("alert-window-contents").innerHTML=A}if(msie){boxes=document.getElementsByTagName("select");alert_select_boxes=[];for(i=0;i<boxes.length;i++){if(boxes[i].style.display!="none"){boxes[i].style.display="none";alert_select_boxes.push(boxes[i])}}}new Effect.BlindDown("alert-window",{duration:1});alert_timeout=window.setTimeout(function(){new Effect.BlindUp("alert-window",{duration:1});msie=((navigator.userAgent.toLowerCase().indexOf("msie")!=-1)&&(navigator.userAgent.toLowerCase().indexOf("opera")==-1));if(msie){for(i=0;i<alert_select_boxes.length;i++){alert_select_boxes[i].style.display="inline"}alert_select_boxes=[]}alert_timeout_end()},dur);return false}function scrollbar_offset(){return scrollbar_offset_filter_results(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)}function scrollbar_offset_filter_results(D,B,A){var C=D?D:0;if(B&&(!C||(C>B))){C=B}return A&&(!C||(C>A))?A:C};